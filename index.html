<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="sk"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;title&gt;Plánovanie predstavení&lt;/title&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;style&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>body {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-family: Arial, sans-serif;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>table {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>width: 100%;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border-collapse: collapse;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-top: 20px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th, td {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: 1px solid #ccc;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 8px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>text-align: center;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>th {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #f4f4f4;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.form-group {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin-bottom: 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>button {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>margin: 2px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>padding: 5px 10px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>font-size: 14px;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>cursor: pointer;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.edit-btn {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #ffc107;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.delete-btn {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #dc3545;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.calendar-btn {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>background-color: #28a745;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>border: none;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>color: white;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;Plánovanie predstavení&lt;/h1&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Formulár na pridávanie údajov --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="date"&gt;Dátum predstavenia:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="date" id="date"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="time"&gt;Čas predstavenia:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="time" id="time"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="performanceType"&gt;Druh predstavenia:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;select id="performanceType"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Kúzelník Tristan"&gt;Kúzelník Tristan&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Kúzelné Vianoce s Tristanom"&gt;Kúzelné Vianoce s Tristanom&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Tristan začarovaný Svetlonos"&gt;Tristan začarovaný Svetlonos&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Tajomstvo začarovanej knižnice"&gt;Tajomstvo začarovanej knižnice&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Tristanovo slizové laboratórium"&gt;Tristanovo slizové laboratórium&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Tristanové bubliny"&gt;Tristanové bubliny&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Balónová zóna"&gt;Balónová zóna&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;option value="Narodeninová oslava"&gt;Narodeninová oslava&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="schoolName"&gt;Názov škôlky:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="schoolName" placeholder="Zadajte názov škôlky"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="schoolAddress"&gt;Adresa škôlky:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="schoolAddress" placeholder="Zadajte adresu škôlky"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="contactPerson"&gt;Kontaktná osoba:&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="text" id="contactPerson" placeholder="Zadajte meno kontaktnej osoby"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="form-group"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;label for="price"&gt;Cena za predstavenie (€):&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;input type="number" id="price" placeholder="Zadajte cenu"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button onclick="addRow()"&gt;Pridať predstavenie&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;!-- Tabuľka na zobrazenie údajov --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;table id="performanceTable"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Dátum&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Čas&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Druh predstavenia&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Názov škôlky&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Adresa&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Kontaktná osoba&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Cena (€)&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;th&gt;Akcie&lt;/th&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;!-- Riadky tabuľky sa pridajú dynamicky --&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/table&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;script&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Funkcia na formátovanie dátumu na deň.mesiac.rok</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function formatDate(dateString) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const date = new Date(dateString);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const day = String(date.getDate()).padStart(2, '0');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const month = String(date.getMonth() + 1).padStart(2, '0'); // Mesiace sú 0-indexované</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const year = date.getFullYear();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>return `${day}.${month}.${year}`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Funkcia na pridanie riadku</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function addRow() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const date = document.getElementById('date').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const time = document.getElementById('time').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const performanceType = document.getElementById('performanceType').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const schoolName = document.getElementById('schoolName').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const schoolAddress = document.getElementById('schoolAddress').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const contactPerson = document.getElementById('contactPerson').value;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const price = document.getElementById('price').value;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (!date || !time || !performanceType || !schoolName || !schoolAddress || !contactPerson || !price) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>alert('Prosím, vyplňte všetky polia.');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const table = document.getElementById('performanceTable').querySelector('tbody');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const row = table.insertRow();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>row.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;${formatDate(date)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;${time}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;${performanceType}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;${schoolName}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;${schoolAddress}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;${contactPerson}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;${price}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button class="edit-btn" onclick="editRow(this)"&gt;Upraviť&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button class="delete-btn" onclick="deleteRow(this)"&gt;Vymazať&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;button class="calendar-btn" onclick="downloadICS('${date}', '${time}', '${performanceType}', '${schoolAddress}', '${schoolName}')"&gt;Exportovať do Kalendára&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Funkcia na vymazanie riadku</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function deleteRow(button) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const confirmDelete = confirm('Naozaj chcete tento záznam vymazať?');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (confirmDelete) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>const row = button.parentElement.parentElement;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>row.remove();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Funkcia na úpravu riadku</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function editRow(button) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const row = button.parentElement.parentElement;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const cells = row.querySelectorAll('td');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('date').value = new Date(cells[0].innerText.split('.').reverse().join('-')).toISOString().split('T')[0];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('time').value = cells[1].innerText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('performanceType').value = cells[2].innerText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('schoolName').value = cells[3].innerText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('schoolAddress').value = cells[4].innerText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('contactPerson').value = cells[5].innerText;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('price').value = cells[6].innerText;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>row.remove();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>// Funkcia na generovanie .ics súboru</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>function downloadICS(date, time, title, location, description) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [year, month, day] = date.split('-');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const [hour, minute] = time.split(':');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const startDate = `${year}${month}${day}T${hour}${minute}00`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const endDate = `${year}${month}${day}T${parseInt(hour) + 1}${minute}00`; // Pridanie jednej hodiny</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const icsContent = `</span></p>
<p class="p1"><span class="s1">BEGIN:VCALENDAR</span></p>
<p class="p1"><span class="s1">VERSION:2.0</span></p>
<p class="p1"><span class="s1">BEGIN:VEVENT</span></p>
<p class="p1"><span class="s1">SUMMARY:${title}</span></p>
<p class="p1"><span class="s1">DESCRIPTION:${description}</span></p>
<p class="p1"><span class="s1">LOCATION:${location}</span></p>
<p class="p1"><span class="s1">DTSTART:${startDate}</span></p>
<p class="p1"><span class="s1">DTEND:${endDate}</span></p>
<p class="p1"><span class="s1">END:VEVENT</span></p>
<p class="p1"><span class="s1">END:VCALENDAR</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const blob = new Blob([icsContent.trim()], { type: 'text/calendar;charset=utf-8' });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const link = document.createElement('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>link.href = URL.createObjectURL(blob);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>link.download = `${title.replace(/\s+/g, '_')}_${date}.ics`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>link.click();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
